<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="MySQL基础：增删改查、库表管理、事务控制"/>




  <meta name="keywords" content="MySQL," />





  <link rel="alternate" href="/paranoiddemon.github.io/atom.xml" title="LANDFILL">




  <link rel="shortcut icon" type="image/x-icon" href="/paranoiddemon.github.io/favicon.ico?v=1.1" />



<link rel="canonical" href="https://landfill.cc/posts/mysql-basic.html"/>


<meta name="description" content="MySQL基础：增删改查、库表管理、事务控制">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础笔记">
<meta property="og:url" content="https://landfill.cc/posts/mysql-basic">
<meta property="og:site_name" content="LANDFILL">
<meta property="og:description" content="MySQL基础：增删改查、库表管理、事务控制">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-06-08T16:22:46.000Z">
<meta property="article:modified_time" content="2020-07-15T14:36:55.988Z">
<meta property="article:author" content="Demon">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">


<link rel="stylesheet" type="text/css" href="/paranoiddemon.github.io/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>


  <link rel="stylesheet" type="text/css" href="/paranoiddemon.github.io/lib/fancybox/jquery.fancybox.css" />




<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: true
    },
  };
</script>




  <script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?87e8c69825473c3f40a93644c2765447";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172058533-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172058533-1');
</script>


    <title> MySQL基础笔记 - LANDFILL </title>
  <meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/paranoiddemon.github.io/atom.xml" title="LANDFILL" type="application/atom+xml">
</head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/paranoiddemon.github.io/." class="logo">LANDFILL</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/paranoiddemon.github.io/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/paranoiddemon.github.io/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          MySQL基础笔记
        
      </h1>

      <time class="post-time">
          Jun 09 2020
      </time>
    </header>



    
            <div class="post-content">
            <p>B站视频教程：<a href="https://www.bilibili.com/video/BV12b411K7Zu?p=1" target="_blank" rel="noopener">MySQL 基础+高级篇- 数据库 -sql -尚硅谷</a><br>MySql8.0：<a href="https://zhuanlan.zhihu.com/p/37152572" target="_blank" rel="noopener">MySql安装</a><br>Navicat 15： <a href="https://www.ghpym.com/navicatpatchdoc.html" target="_blank" rel="noopener">Navicat注册机</a></p>
<p>DB/DBMS</p>
<p>Sql/MySql</p>
<table>
<thead>
<tr>
<th>分类</th>
<th>中文</th>
<th>语法</th>
</tr>
</thead>
<tbody><tr>
<td>DQL（Data Query Language）</td>
<td>数据查询语言</td>
<td>select</td>
</tr>
<tr>
<td>DML  (Data Manipulate Language)</td>
<td>数据操作语言</td>
<td>insert 、update、delete</td>
</tr>
<tr>
<td>DDL（Data Define Languge）</td>
<td>数据定义语言</td>
<td>create、drop、alter</td>
</tr>
<tr>
<td>TCL（Transaction Control Language）</td>
<td>事务控制语言</td>
<td>commit、rollback</td>
</tr>
</tbody></table>
<h1 id="DQL-查询"><a href="#DQL-查询" class="headerlink" title="DQL 查询"></a>DQL 查询</h1><h2 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">语法：</span><br><span class="line">SELECT 查询列表 FROM 表名；</span><br><span class="line"></span><br><span class="line">特点：</span><br><span class="line">1.查询列表可以是：表中的字段、常量值、表达式、函数</span><br><span class="line">2.查询的结果是一个虚拟的表格</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line">#1. 查询单个字段</span><br><span class="line">SELECT email FROM employees;</span><br><span class="line"></span><br><span class="line">#2. 查询多个字段</span><br><span class="line">SELECT email, last_name FROM employees;</span><br><span class="line"></span><br><span class="line">#3. 查询全部字段</span><br><span class="line">SELECT * FROM employees;</span><br><span class="line"></span><br><span class="line">#4. 查询常量值</span><br><span class="line">SELECT 100;</span><br><span class="line">SELECT &#39;john&#39;;</span><br><span class="line"></span><br><span class="line">#5.查询表达式</span><br><span class="line">SELECT 100*98;</span><br><span class="line"></span><br><span class="line">#6.查询函数</span><br><span class="line">SELECT VERSION();</span><br><span class="line"></span><br><span class="line">#7.字段起别名</span><br><span class="line">&#x2F;*</span><br><span class="line">1.便于理解</span><br><span class="line">2.如果要查询的字段有重名，可以区分开</span><br><span class="line">*&#x2F;</span><br><span class="line">#方式一：使用as</span><br><span class="line">SELECT 100*98 AS 结果;</span><br><span class="line">SELECT last_name AS 姓,first_name AS 名 FROM employees;</span><br><span class="line"></span><br><span class="line">#方式二：使用空格</span><br><span class="line">SELECT last_name 姓,first_name 名 FROM employees;</span><br><span class="line"></span><br><span class="line">#案例：查询salary，显示结果为out put,含有关键词或者空格</span><br><span class="line">SELECT salary  AS &quot;out put&quot; FROM employees;</span><br><span class="line"></span><br><span class="line">#8.去重</span><br><span class="line"></span><br><span class="line">#案例：查询员工表中中涉及到的所有的部门编号</span><br><span class="line">SELECT DISTINCT department_id FROM employees;</span><br><span class="line"></span><br><span class="line">#9.+号的作用</span><br><span class="line">&#x2F;*</span><br><span class="line">mysql中的+号：</span><br><span class="line">仅仅只有一个功能：运算符</span><br><span class="line"></span><br><span class="line">1.两个操作数都为数值型，则做加法运算</span><br><span class="line">  SELECT 100+90; </span><br><span class="line"></span><br><span class="line">2.其中一方为字符型，试图将字符型数值转换成数值型</span><br><span class="line">- SELECT &#39;123&#39;+90;   如果转换成功，则继续做加法运算</span><br><span class="line">- SELECT &#39;John&#39;+90;  如果转换失败，则将字符型数值转换成0</span><br><span class="line">- SELECT null +10;   只要其中一方为null，则结果肯定为null；</span><br><span class="line">*&#x2F;</span><br><span class="line"># 查询员工们和姓连接过程一个字段</span><br><span class="line">SELECT last_name+first_name AS 姓名 FROM employees;</span><br><span class="line">SELECT CONCAT(last_name,&#39; &#39;, first_name) AS 姓名 FROM employees;</span><br><span class="line"></span><br><span class="line">#显示表的结构，并查询全部数据</span><br><span class="line">DESC departments;</span><br><span class="line">SELECT * FROM departments;</span><br><span class="line"></span><br><span class="line">#显示出employees的全部列，各个列之间用逗号连接，列头为output</span><br><span class="line">SELECT </span><br><span class="line">IFNULL(commission_pct,0) AS 奖金率,commission_pct</span><br><span class="line">FROM</span><br><span class="line">employees;</span><br><span class="line">#----------------------------------------------------</span><br><span class="line">SELECT </span><br><span class="line">CONCAT(first_name,&#39; &#39;,last_name,&#39;,&#39;,IFNULL(commission_pct,0)) AS output</span><br><span class="line">FROM</span><br><span class="line">employees;</span><br></pre></td></tr></table></figure>
<h2 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">语法：</span><br><span class="line">SELECT 查询列表</span><br><span class="line">FROM 表名 </span><br><span class="line">WHERE 筛选条件；</span><br><span class="line"></span><br><span class="line">分类：</span><br><span class="line">1. 按条件表达式筛选</span><br><span class="line">条件运算符：&gt; &lt; &#x3D; !&#x3D; or &lt;&gt; &gt;&#x3D; &lt;&#x3D;</span><br><span class="line"></span><br><span class="line">2.按逻辑表达式筛选</span><br><span class="line">逻辑运算符：用于连接条件表达式</span><br><span class="line">							&amp;&amp; || ！</span><br><span class="line">						and or not</span><br><span class="line">	and: 两个条件都为true</span><br><span class="line">	or: 一个条件为true，则为true</span><br><span class="line">	not：相反</span><br><span class="line">	</span><br><span class="line">3.模糊查询</span><br><span class="line">like</span><br><span class="line">between and</span><br><span class="line">in</span><br><span class="line">is null</span><br><span class="line">*&#x2F;</span><br><span class="line">#1.按条件表达式筛选</span><br><span class="line">#案例1：查询工资&gt;12000的员工信息</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">salary&gt;12000;</span><br><span class="line">#案例2：查询部门编号不等于90的员工名和部门编号</span><br><span class="line">SELECT</span><br><span class="line">last_name, department_id</span><br><span class="line">FROM </span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">department_id!&#x3D;90 ;</span><br><span class="line"></span><br><span class="line">#2.按逻辑表达式筛选</span><br><span class="line"></span><br><span class="line">#案例1：查询工资在10000-20000的员工名、工资、及奖金</span><br><span class="line">SELECT </span><br><span class="line">CONCAT(first_name,&#39; &#39;,last_name) AS &#39;name&#39;,</span><br><span class="line">salary,</span><br><span class="line">IFNULL(commission_pct,0) AS comission</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">salary&gt;&#x3D;10000 AND salary&lt;&#x3D;20000;</span><br><span class="line"></span><br><span class="line">#案例2：查询部门编号不在90-110之间，或者工资高于15000的员工信息</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">department_id&lt;90 OR department_id&gt;110 OR salary&gt;&#x3D;15000;</span><br><span class="line"></span><br><span class="line">#3.模糊查询</span><br><span class="line">&#x2F;*</span><br><span class="line">like </span><br><span class="line">特点：</span><br><span class="line">一般和通配符搭配使用</span><br><span class="line">					通配符：</span><br><span class="line">						% 任意多个字符，包含0个字符</span><br><span class="line">						_ 任意单个字符</span><br><span class="line">						\ 转义字符</span><br><span class="line">between and</span><br><span class="line">in</span><br><span class="line">is null</span><br><span class="line">is not null</span><br><span class="line">*&#x2F;</span><br><span class="line">#1.like</span><br><span class="line"></span><br><span class="line">#案例1：查询员工名中包含字符a的员工信息</span><br><span class="line"></span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">last_name LIKE &#39;%a%&#39;;</span><br><span class="line"></span><br><span class="line">#案例2：查询员工名中第三个字符为n，第五个字符为l的员工名和工资</span><br><span class="line">SELECT</span><br><span class="line">last_name,salary</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">last_name like &#39;__n_l%&#39;;</span><br><span class="line"></span><br><span class="line">#案例3：查询员工名中第二个字符为_的员工信息</span><br><span class="line">SELECT</span><br><span class="line">last_name</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">last_name LIKE &#39;_a_%&#39; ESCAPE &#39;a&#39;;</span><br><span class="line"># 效果一样last_name LIKE &#39;_\_%&#39;;</span><br><span class="line"></span><br><span class="line">#2. between and </span><br><span class="line">#case 1: 查询员工编号在100-120的员工信息</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">employee_id BETWEEN 100 AND 120; #包含临界值，不可以颠倒临界值顺序</span><br><span class="line"></span><br><span class="line">#3. in</span><br><span class="line">&#x2F;*</span><br><span class="line">判断某字段的值是否属于in列表中的某一项</span><br><span class="line">-提高简洁度</span><br><span class="line">-in列表的值类型必须一致或兼容</span><br><span class="line">-不支持通配符的使用</span><br><span class="line">*&#x2F;</span><br><span class="line"># case：查询员工的工种编号是IT_PROG、AD_VP、AD_PRES中的员工名和工种编号</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">job_id</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE </span><br><span class="line">job_id &#x3D;&#39;IT_PROG&#39; OR job_id&#x3D;&#39;AD_VP&#39; OR job_id&#x3D;&#39;AD_PRES&#39;;</span><br><span class="line">#-------------------------------------------------------</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">job_id</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE </span><br><span class="line">job_id IN(&#39;IT_PROG&#39;,&#39;AD_VP&#39; ,&#39;AD_PRES&#39;);</span><br><span class="line"></span><br><span class="line">#4 is null&#x2F; is not null</span><br><span class="line">&#x2F;*</span><br><span class="line">&#x3D; &lt;&gt;不能判断null值，is&#x2F; is not 才可以判断null值</span><br><span class="line">*&#x2F;</span><br><span class="line"># case1:查询没有奖金的员工名和奖金率</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">commission_pct</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">commission_pct is NULL;	</span><br><span class="line"></span><br><span class="line">#安全等于&lt;&#x3D;&gt; 判断null值和普通数值</span><br><span class="line"># case1:查询没有奖金的员工名和奖金率</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">commission_pct</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">commission_pct &lt;&#x3D;&gt; NULL;	</span><br><span class="line"></span><br><span class="line">#case2:查询工资为12000的员工信息</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">salary</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">salary &lt;&#x3D;&gt; 12000;	</span><br><span class="line"></span><br><span class="line">#查询员工号为176的姓名和部门号和年薪</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">department_id,</span><br><span class="line">salary*12*(1+IFNULL(commission_pct,0)) AS &#39;annual salary&#39;</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">employee_id&#x3D;176;</span><br><span class="line"></span><br><span class="line">#测试题</span><br><span class="line">#1.查询没有奖金，且工资小于18000的salary,last_name</span><br><span class="line">SELECT</span><br><span class="line">salary,</span><br><span class="line">last_name</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">commission_pct is NULL </span><br><span class="line">AND salary&lt;18000;</span><br><span class="line"></span><br><span class="line">#2.查询employees表中，job_id不为‘IT’或者工资为12000的员工信息</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">job_id &lt;&gt;&#39;IT&#39; OR salary&#x3D;12000;</span><br><span class="line"></span><br><span class="line">#3.查询departments的结构</span><br><span class="line">DESC departments;</span><br><span class="line"></span><br><span class="line">#4.查询departments表中涉及到了哪些位置编号</span><br><span class="line">SELECT DISTINCT</span><br><span class="line">location_id</span><br><span class="line">FROM</span><br><span class="line">departments;</span><br><span class="line"></span><br><span class="line">&#x2F;*5.SELECT * FROM employees 和</span><br><span class="line">SELECT * FROM employees WHERE commission_pct like&#39;%%&#39; AND last name like &#39;%%&#39;</span><br><span class="line">结果是否一样，原因</span><br><span class="line">不一样，值存在null的情况</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">SELECT * from employees;</span><br><span class="line"></span><br><span class="line">语法：</span><br><span class="line">SELECT 列表</span><br><span class="line">FROM 表</span><br><span class="line">WHERE 筛选条件</span><br><span class="line">ORDER BY 排序列表 DESC&#x2F;ASC</span><br><span class="line"> 1.ORDER BY子句支持单个字段、多个字段、表达式、函数、别名</span><br><span class="line"> 2.ORDER BY子句一般是放在查询语句的最后面，limit子句除外</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#case 1：查询员工信息，要求工资从高到低排序</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY</span><br><span class="line">salary</span><br><span class="line">DESC;</span><br><span class="line"></span><br><span class="line">#------------------------------升序是默认的，可以不用写出</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY</span><br><span class="line">salary</span><br><span class="line">ASC;</span><br><span class="line"></span><br><span class="line">#case 2：查询部门编号&gt;&#x3D;90的员工信息，按入职时间的先后（筛选条件）</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">department_id&gt;&#x3D;90</span><br><span class="line">ORDER BY</span><br><span class="line">hiredate;</span><br><span class="line"></span><br><span class="line">#case 3：按年薪的高低显示员工信息（按表达式排序）</span><br><span class="line">SELECT</span><br><span class="line">*,salary*12*(1+IFNULL(commission_pct,0)) &#39;annual salary&#39; </span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY</span><br><span class="line">salary*12*(1+IFNULL(commission_pct,0)) DESC;</span><br><span class="line"></span><br><span class="line">#case 4:按年薪的高低显示员工信息（按别名排序）</span><br><span class="line">SELECT</span><br><span class="line">*,salary*12*(1+IFNULL(commission_pct,0)) &#39;annual salary&#39; </span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY</span><br><span class="line">&#39;annual salary&#39; DESC;</span><br><span class="line"></span><br><span class="line">#case 5:按姓名的长度显示员工的姓名和工资（按函数）</span><br><span class="line">SELECT </span><br><span class="line">LENGTH(last_name),last_name,salary</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY LENGTH(last_name) DESC;</span><br><span class="line"></span><br><span class="line">#case 6:查询员工信息，先按工资排序，再按员工编号排序(按多个字段排序）</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY salary ASC,employee_id DESC;</span><br><span class="line"></span><br><span class="line">#1.查询员工的姓名、部门号、年薪，按年薪降序，按姓名升序</span><br><span class="line">SELECT</span><br><span class="line">last_name,</span><br><span class="line">department_id,</span><br><span class="line">salary*12*(1+IFNULL(commission_pct,0)) &#39;annual salary&#39;</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">ORDER BY</span><br><span class="line">&#39;annual salary&#39; DESC,last_name;</span><br><span class="line"></span><br><span class="line">#2.选择工资不在8000-17000的员工的姓名和工资，按工资降序</span><br><span class="line">SELECT</span><br><span class="line">last_name,salary</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">#salary&lt;8000 OR salary&gt;17000</span><br><span class="line">#NOT (salary BETWEEN 8000 AND 17000) </span><br><span class="line">salary NOT BETWEEN 8000 AND 17000</span><br><span class="line">ORDER BY</span><br><span class="line">salary DESC;</span><br><span class="line"></span><br><span class="line">#3.查询邮箱中包含e的员工信息，按邮箱字节数降序，按部门号升序</span><br><span class="line">SELECT </span><br><span class="line">*,LENGTH(email)</span><br><span class="line">FROM</span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">email like &#39;%e%&#39;</span><br><span class="line">ORDER BY</span><br><span class="line">LENGTH(email) DESC,department_id;</span><br></pre></td></tr></table></figure>

<h2 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">概念：一组逻辑语句封装在方法体重，对外暴露方法名</span><br><span class="line">1.隐藏了实现细节</span><br><span class="line">2.提高代码的重用性</span><br><span class="line">调用：SELECT 函数名(实参列表) [from 表]；如果调用了表内的字段</span><br><span class="line">特点：1.函数名 2.函数功能</span><br><span class="line">函数可以自定义</span><br><span class="line">分类：</span><br><span class="line">			1.单行函数：CONCAT、LENGTH，IFNULL等，做处理使用</span><br><span class="line">			2.分组函数：做统计使用，传一组值，返回一个值，又称为统计函数、聚合函数、组函数</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#1. 单行函数</span><br><span class="line">&#x2F;*</span><br><span class="line">	字符函数 concat substr instr length lpad rpad upper lower trim replace</span><br><span class="line">	数学函数  ceil floor truncate mod round</span><br><span class="line">	日期函数 now curdate curtime year month day hour minute second  str_to_date date_format monthname</span><br><span class="line">	其他函数 version datebase user</span><br><span class="line">	流程控制函数 if case的两种用法</span><br><span class="line">*&#x2F;</span><br><span class="line">			</span><br><span class="line">#一、字符函数</span><br><span class="line"></span><br><span class="line">#1.length 获取参数值的字节个数</span><br><span class="line">SELECT LENGTH(&#39;john&#39;);</span><br><span class="line">SELECT LENGTH(&#39;啊&#39;); #utf8字符集，汉字占3个字节</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#39;%char%&#39; #展示字符集</span><br><span class="line"></span><br><span class="line">#2.concat 拼接字符串</span><br><span class="line">SELECT CONCAT(last_name,&#39;_&#39;,first_name) &#39;name&#39;</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#3.upper、lower 改变大小写</span><br><span class="line">SELECT UPPER(&#39;john&#39;);</span><br><span class="line">SELECT LOWER(&#39;jOHN&#39;);</span><br><span class="line"># e.g. 将姓大写，名小写,然后拼接</span><br><span class="line">SELECT</span><br><span class="line">CONCAT(UPPER(last_name),&#39; &#39;,LOWER(first_name)) &#39;NAME&#39; #函数可以嵌套</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#4.substr、substring 截取字符串</span><br><span class="line">SELECT SUBSTR(&#39;annihilation&#39;,3);   #索引都是从1开始的， nihilation</span><br><span class="line">SELECT SUBSTR(&#39;annihilation&#39;,1,3); #ann 索引，长度</span><br><span class="line"></span><br><span class="line">#case: 姓名中首字符大写，其他小写后用_拼接</span><br><span class="line">SELECT </span><br><span class="line">CONCAT(UPPER(SUBSTR(last_name,1,1)),&#39;_&#39;,LOWER(SUBSTR(last_name,2)))</span><br><span class="line">FROM</span><br><span class="line">employees;</span><br><span class="line"></span><br><span class="line">#5.instr 返回子串在字符串中的第一次出现的起始索引</span><br><span class="line">SELECT INSTR(&#39;annihilation&#39;,&#39;nihilation&#39;);</span><br><span class="line"></span><br><span class="line">#6.trim  去除两端的字符</span><br><span class="line">SELECT LENGTH(TRIM(&#39;  annihilation  &#39;));</span><br><span class="line">SELECT TRIM(&#39;a&#39; FROM &#39;aannihilationa&#39;); #输出nnihilation</span><br><span class="line"></span><br><span class="line">#7.lpad 用指定字符左填充指定长度</span><br><span class="line">SELECT LPAD(&#39;annihilation&#39;,20,&#39;-&#39;) AS output; #--------annihilation</span><br><span class="line">SELECT LPAD(&#39;annihilation&#39;,2,&#39;-&#39;) AS output;  #an</span><br><span class="line"></span><br><span class="line">#8.rpad 用指定字符右填充指定长度</span><br><span class="line">SELECT RPAD(&#39;annihilation&#39;,20,&#39;-&#39;) AS output; #annihilation--------</span><br><span class="line"></span><br><span class="line">#9.replace 替换</span><br><span class="line">SELECT REPLACE(&#39;abc&#39;,&#39;a&#39;,&#39;z&#39;);</span><br><span class="line"></span><br><span class="line">#二、数学函数</span><br><span class="line"></span><br><span class="line">#round 四舍五入</span><br><span class="line">SELECT ROUND(1.65);  #2</span><br><span class="line">SELECT ROUND(1.45);  #1</span><br><span class="line">SELECT ROUND(-1.65); #-2</span><br><span class="line">SELECT ROUND(1.657,2); #1.66 保留2位</span><br><span class="line"></span><br><span class="line">#ceil 向上取整，返回&gt;&#x3D;该参数的最小整数</span><br><span class="line">SELECT CEIL(1.52);  #2</span><br><span class="line">SELECT CEIL(1.00);  #1 </span><br><span class="line">SELECT CEIL(-1.02); #-1 </span><br><span class="line"></span><br><span class="line">#floor 向下取证，返回&lt;&#x3D;该参数的最大整数</span><br><span class="line">SELECT FLOOR(9.8)   #9</span><br><span class="line">SELECT FLOOR(-9.8)  #-10</span><br><span class="line"></span><br><span class="line">#truncate 截断</span><br><span class="line">SELECT TRUNCATE(1.699,1)  #1.6</span><br><span class="line"></span><br><span class="line">#mod 取余</span><br><span class="line">&#x2F;*</span><br><span class="line">mod(a,b): a-a&#x2F;b*b  (其中a&#x2F;b是取整数）</span><br><span class="line">*&#x2F;</span><br><span class="line">SELECT MOD(10,3); #1</span><br><span class="line">SELECT 10%3;</span><br><span class="line">SELECT MOD(-10,3); #-1  根据被除数的正负，取正负</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、日期函数</span><br><span class="line"></span><br><span class="line">#now 返回当前系统日期及时间 2020-06-10 17:10:22</span><br><span class="line">SELECT NOW();</span><br><span class="line"></span><br><span class="line">#curdate 返回当前系统日期   2020-06-10</span><br><span class="line">SELECT CURDATE(); </span><br><span class="line"></span><br><span class="line">#curtime 返回当前时间   17:12:15</span><br><span class="line">SELECT CURTIME();</span><br><span class="line"></span><br><span class="line">#获取指定的部分：年月日、时分秒</span><br><span class="line">SELECT YEAR(NOW());</span><br><span class="line">SELECT YEAR(&#39;1900-1-1&#39;);</span><br><span class="line">SELECT YEAR(hiredate) FROM employees;</span><br><span class="line"></span><br><span class="line">SELECT MONTH(NOW());     # 6</span><br><span class="line">SELECT MONTHNAME(NOW()); # June</span><br><span class="line"></span><br><span class="line">#DAY(date),HOUR(time),MINUTE(time),SECOND(time)</span><br><span class="line"></span><br><span class="line">#STR_TO_DATE(str,format) 将字符串转换成指定格式的日期</span><br><span class="line">&#x2F;*格式符</span><br><span class="line">%Y  20xx</span><br><span class="line">%y  xx</span><br><span class="line">%m  01,02...12</span><br><span class="line">%c  1,2...12</span><br><span class="line">%d  01,02...31</span><br><span class="line">%H  01,02...24</span><br><span class="line">%h  01,02...12</span><br><span class="line">%i  00,01...59</span><br><span class="line">%s  00,01...69</span><br><span class="line">*&#x2F;</span><br><span class="line">SELECT STR_TO_DATE(&#39;1900-01-01&#39;,&#39;%Y-%m-%d&#39;);</span><br><span class="line"></span><br><span class="line">#case 查询入职日期1992-4-3的员工信息</span><br><span class="line">SELECT *FROM employees</span><br><span class="line">WHERE hiredate&#x3D; STR_TO_DATE(&#39;4-3 1992&#39;,&#39;%c-%d %Y&#39;);</span><br><span class="line"></span><br><span class="line">#DATE_FORMAT(date,format) 将日期转换成字符</span><br><span class="line">SELECT DATE_FORMAT(&#39;2008&#x2F;1&#x2F;1&#39;,&#39;%Y年%m月%d日&#39;);</span><br><span class="line"></span><br><span class="line">#四、其他函数</span><br><span class="line">SELECT VERSION();</span><br><span class="line">SELECT DATABASE();</span><br><span class="line">SELECT USER();</span><br><span class="line"></span><br><span class="line">#五、流程控制函数</span><br><span class="line">#1.if函数：if else的效果</span><br><span class="line">SELECT IF(10&gt;5,&#39;大&#39;,&#39;小&#39;) ; #expr1条件表达式，true返回expr2，false返回expr3</span><br><span class="line">SELECT last_name,commission_pct, IF(commission_pct is null,&#39;no&#39;,&#39;yes&#39;) # if前面要加逗号</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#2.case函数的使用一：switch case的效果</span><br><span class="line">&#x2F;*</span><br><span class="line">java中 </span><br><span class="line">switch(变量或表达式）&#123;</span><br><span class="line">       case 常量1：语句1；break；</span><br><span class="line">			 ...</span><br><span class="line">			 default:语句n;break;</span><br><span class="line">			 </span><br><span class="line">			 &#125;</span><br><span class="line">			 </span><br><span class="line">mysql中   判断等值</span><br><span class="line">  CASE 要判断的变量或表达式						</span><br><span class="line">	WHEN 常量1 THEN 要显示的值1或语句1； </span><br><span class="line">	WHEN 常量2 THEN 要显示的值2或语句2；</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">	ELSE 要显示的值n或语句n；</span><br><span class="line">  END </span><br><span class="line">#如果是在select后面，case作为表达式，只能显示为值，而不能用语句</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;*案例：查询员工的工资，要求</span><br><span class="line">部门号&#x3D;30，显示的工资为1.1倍</span><br><span class="line">部门号&#x3D;40，显示的工资为1.2倍</span><br><span class="line">部门号&#x3D;50，显示的工资为1.3倍</span><br><span class="line">其他部门，显示为原工资</span><br><span class="line">*&#x2F;</span><br><span class="line">SELECT salary,department_id,</span><br><span class="line">  CASE department_id</span><br><span class="line">	WHEN  30 THEN salary*1.1   #是个值，不用加分号</span><br><span class="line">	WHEN  40 THEN salary*1.2 </span><br><span class="line">	WHEN  50 THEN salary*1.3</span><br><span class="line">	ELSE  salary</span><br><span class="line">  END AS &#39;new salary&#39;</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#3.case函数的使用二：类似于多重if</span><br><span class="line">&#x2F;*</span><br><span class="line">java中：</span><br><span class="line">if(条件1）｛</span><br><span class="line">				语句1；</span><br><span class="line">｝</span><br><span class="line">else if(条件2）｛</span><br><span class="line">				语句2；</span><br><span class="line">｝</span><br><span class="line">...</span><br><span class="line">else&#123;</span><br><span class="line">				语句n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysql中：</span><br><span class="line">case   														#后面没有变量或表达式，判断区间</span><br><span class="line">when 条件1 then 显示值1 或语句1；</span><br><span class="line">when 条件2 then 显示值2 或语句2；</span><br><span class="line">...</span><br><span class="line">else 显示值n或语句n；</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line">&#x2F;*</span><br><span class="line">#案例：查询员工的工资情况</span><br><span class="line">如果工资&gt;20000，显示A</span><br><span class="line">如果工资&gt;15000，显示B</span><br><span class="line">如果工资&gt;10000，显示C</span><br><span class="line">否则D</span><br><span class="line">*&#x2F;</span><br><span class="line">SELECT salary,</span><br><span class="line">CASE</span><br><span class="line">WHEN salary&gt;20000 THEN &#39;A&#39;   #字符串一定要加单引号</span><br><span class="line">WHEN salary&gt;15000	THEN &#39;B&#39;</span><br><span class="line">WHEN salary&gt;10000 THEN &#39;C&#39;</span><br><span class="line">ELSE &#39;D&#39;</span><br><span class="line">END AS &#39;rank&#39;</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#练习</span><br><span class="line">#1.显示系统时间（时间+日期）</span><br><span class="line">SELECT NOW();</span><br><span class="line">#2.查询员工号、姓名、工资、以及工资提高20%后的结果</span><br><span class="line">SELECT employee_id,last_name,salary,salary*1.2 as &#39;new salary&#39;</span><br><span class="line">FROM employees</span><br><span class="line">#3.将员工的姓名按首字母排序，写出姓名长度</span><br><span class="line">SELECT last_name,length(last_name) as length,substr(last_name,1,1) as initial</span><br><span class="line">FROM employees</span><br><span class="line">ORDER BY initial;</span><br><span class="line">#区别于order by last_name 效果不一样，先首字母，后第二个字母。按initial排序，后面是随机的</span><br><span class="line"></span><br><span class="line">#4.做一个查询，产生下面结果</span><br><span class="line">&#x2F;*&lt;last_name&gt; earns &lt;salary&gt; monthly but wants &lt;salary*3&gt;</span><br><span class="line">Dream Salary</span><br><span class="line">K_ing earns 24000.00 monthly but wants 72000.00</span><br><span class="line">*&#x2F;</span><br><span class="line">SELECT CONCAT(last_name,&#39; earns &#39;,salary,&#39; monthly but wants &#39;, salary*3) as &#39;Dream Salary&#39;</span><br><span class="line">FROM employees</span><br><span class="line">WHERE last_name&#x3D;&#39;K_ing&#39; and salary&#x3D;24000;</span><br><span class="line"></span><br><span class="line">#5. 使用case when，按照下面的条件</span><br><span class="line"> job     grade</span><br><span class="line">AD_PRES    A</span><br><span class="line">ST_MAN     B</span><br><span class="line">IT_PROG    C</span><br><span class="line"></span><br><span class="line">SELECT last_name,job_id job, </span><br><span class="line">CASE job_id</span><br><span class="line">WHEN &#39;AD_PRES&#39; THEN &#39;A&#39;  #字符串一定要加引号</span><br><span class="line">WHEN &#39;ST_MAN&#39;  THEN &#39;B&#39;</span><br><span class="line">WHEN &#39;IT_PROG&#39; THEN &#39;C&#39;</span><br><span class="line">END AS grade</span><br><span class="line">FROM employees</span><br><span class="line">WHERE job_id&#x3D;&#39;AD_PRES&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、分组函数</span><br><span class="line">&#x2F;*</span><br><span class="line">功能：用作统计使用，又称聚合函数、统计函数、组函数</span><br><span class="line">分类</span><br><span class="line">sum</span><br><span class="line">avg</span><br><span class="line">max</span><br><span class="line">min</span><br><span class="line">count：计算非空的</span><br><span class="line"></span><br><span class="line">特点：</span><br><span class="line">1.忽略null</span><br><span class="line">2.和dinstinct搭配使用</span><br><span class="line">3.和分组函数一同查询的字段要求是group by后的字段</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#1.简单使用</span><br><span class="line">SELECT SUM(salary) FROM employees;</span><br><span class="line">SELECT AVG(salary) FROM employees;</span><br><span class="line">SELECT min(salary) FROM employees;</span><br><span class="line">SELECT MAX(salary) FROM employees;</span><br><span class="line">SELECT COUNT(salary) FROM employees;</span><br><span class="line"></span><br><span class="line">SELECT SUM(salary) 和,ROUND(AVG(salary),2) 平均,min(salary),MAX(salary),COUNT(salary)</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#2.参数支持类型</span><br><span class="line">&#x2F;*</span><br><span class="line">sum avg：数值型</span><br><span class="line">max min count ：字符型也可以做参数</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#3.是否忽略null</span><br><span class="line">&#x2F;*</span><br><span class="line">null+任何数为null</span><br><span class="line">sum avg:忽略</span><br><span class="line">max min count ：忽略</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#4.搭配distinct  去重</span><br><span class="line">SELECT </span><br><span class="line">SUM(DISTINCT salary),  #中间没有逗号</span><br><span class="line">SUM(salary) </span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">SELECT COUNT(DISTINCT salary) FROM employees;</span><br><span class="line"></span><br><span class="line">#5.count函数的详细介绍</span><br><span class="line">SELECT COUNT(*) FROM employees; #统计行数</span><br><span class="line">SELECT COUNT(1) FROM employees; #加了1列1，统计行数</span><br><span class="line">SELECT COUNT(2） FROM employees; </span><br><span class="line">SELECT COUNT(&#39;abc&#39;) FROM employees; #加了1列常量，统计行数</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">效率：</span><br><span class="line">MYISAM存储引擎，count（*）效率高</span><br><span class="line">INNODB存储引擎，count（*）和count（1）相似，比count（字段）高</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#6.和分组函数一同查询的字段有限制</span><br><span class="line">SELECT AVG(salary),employee_id FROM employees; # employee_id的值无意义</span><br><span class="line"></span><br><span class="line">#查询最大入职时间和最小入职时间相差天数</span><br><span class="line">SELECT DATEDIFF(NOW(),&#39;1996-09-12&#39;) #前面减后面 8673</span><br><span class="line"></span><br><span class="line"># 查询部门编号为90的员工个数</span><br><span class="line">SELECT COUNT(department_id) #不能用count（department_id&#x3D;90）,结果和count(department_id)一样</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">SELECT COUNT(*)</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id&#x3D;90;</span><br></pre></td></tr></table></figure>

<h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><figure class="highlight plain"><figcaption><span>sql	</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#查询每个部门的平均工资</span><br><span class="line">&#x2F;*</span><br><span class="line">SELECT column(要出现在group by后面, group_function()</span><br><span class="line">FROM table</span><br><span class="line">[WHERE 筛选条件]</span><br><span class="line">GROUP BY  分组的列表</span><br><span class="line">[ORDER BY 字句]</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">		查询列表必须特殊，要求是分组函数和group by后出现的字段	</span><br><span class="line">		where一定放在from后面</span><br><span class="line">		</span><br><span class="line">特点：1.分组查询中的筛选条件分为两类</span><br><span class="line">	|	 			|数据源				|位置					|关键字|</span><br><span class="line">	|---------------|----------------------|-------------------|------|</span><br><span class="line">	|分组前筛选       |原始表			 |group by子句前		    | where|</span><br><span class="line">    |分组后筛选		 |分组后的结果集	  |group by子句后		     | having|</span><br><span class="line">				</span><br><span class="line">				分组函数（max min sum avg count）做条件肯定是放在having子句中</span><br><span class="line">				能用分组前筛选的，优先考虑分组前筛选</span><br><span class="line">				</span><br><span class="line">			2.group by子句支持表达式，单个字段，多个字段（用逗号隔开）</span><br><span class="line">			3.也可以添加排序，在整个分组查询的最后</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#简单的分组查询</span><br><span class="line"># case 1:查询每个工种的最高工资</span><br><span class="line">SELECT MAX(salary),job_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY job_id;</span><br><span class="line"></span><br><span class="line"># case 2：查询每个位置上的部门个数</span><br><span class="line">SELECT COUNT(DISTINCT department_id),location_id</span><br><span class="line">FROM departments</span><br><span class="line">GROUP BY location_id;</span><br><span class="line"></span><br><span class="line">#推加筛选条件</span><br><span class="line"># case 1：邮箱中包含a字符的，每个部门的平均工资</span><br><span class="line">SELECT AVG(salary),department_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE email LIKE &#39;%a%&#39;</span><br><span class="line">GROUP BY department_id;</span><br><span class="line"></span><br><span class="line"># case 2:查询每个领导手下有奖金的员工的最高工资</span><br><span class="line">SELECT MAX(salary),manager_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE commission_pct is not null</span><br><span class="line">GROUP BY manager_id;</span><br><span class="line"></span><br><span class="line">#添加复杂的筛选条件</span><br><span class="line">#案例1：查询哪个部门的员工个数&gt;2</span><br><span class="line">#a.查询每个部门的员工数</span><br><span class="line">SELECT COUNT(*), department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id;</span><br><span class="line">#b.根据前面的结果进行筛选</span><br><span class="line">SELECT COUNT(*), department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line">HAVING COUNT(*)&gt;2;      #分号视作语句的结束，在最后面用</span><br><span class="line"></span><br><span class="line">#case 2:查询每个工种有奖金的员工最高工资&gt;12000的工种编号和最高工资</span><br><span class="line">SELECT MAX(salary),job_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE commission_pct is not NULL</span><br><span class="line">GROUP BY job_id</span><br><span class="line">HAVING MAX(salary)&gt;12000;</span><br><span class="line"></span><br><span class="line">#case 3:查询领导编号&gt;102的每个领导手下的最低工资&gt;5000的领导编号及最低工资</span><br><span class="line">SELECT MIN(salary), manager_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE manager_id&gt;102</span><br><span class="line">GROUP BY manager_id </span><br><span class="line">HAVING MIN(salary)&gt;5000;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#按表达式或函数分组</span><br><span class="line"># case：按员工姓名的长度分组，查询每一组的员工个数，筛选员工数&gt;5的</span><br><span class="line">SELECT COUNT(*),LENGTH(last_name)</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY LENGTH(last_name)</span><br><span class="line">HAVING COUNT(*)&gt;5;</span><br><span class="line"></span><br><span class="line">#按多个字段分组</span><br><span class="line">#case：查询每个部门每个工种的平均工资</span><br><span class="line">SELECT AVG(salary),department_id,job_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id,job_id; #可以调换顺序</span><br><span class="line"></span><br><span class="line">#添加排序</span><br><span class="line">#case：查询每个部门每个工种的平均工资，并且按照平均工资高低显示</span><br><span class="line">SELECT AVG(salary),department_id,job_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id is NOT NULL</span><br><span class="line">GROUP BY department_id,job_id</span><br><span class="line">HAVING AVG(salary)&gt;10000     #having和group by支持别名</span><br><span class="line">ORDER BY AVG(salary) DESC;</span><br><span class="line"></span><br><span class="line">#1.查询个job_id员工工资的最大值、最小值、平均值、和，按job_id升序</span><br><span class="line">SELECT MAX(salary),MIN(salary),AVG(salary),SUM(salary),job_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY job_id</span><br><span class="line">ORDER BY job_id;</span><br><span class="line"></span><br><span class="line">#2.最高最低工资的差距</span><br><span class="line">SELECT MAX(salary)-MIN(salary)</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#3.查询各个管理者手下员工的最低工资，其中最低工资不能低于6000，没有管理者的员工不计入</span><br><span class="line">SELECT MIN(salary),manager_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE manager_id is not null</span><br><span class="line">GROUP BY manager_id</span><br><span class="line">HAVING MIN(salary)&gt;&#x3D;6000;</span><br><span class="line"></span><br><span class="line">#4.查询所有部门的编号，员工数量和工资平均值，按平均工资降序</span><br><span class="line">SELECT department_id,COUNT(*) quantity,ROUND(AVG(salary),2) avgsal</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line">ORDER BY AVG(salary) DESC;</span><br><span class="line"></span><br><span class="line">#5.选择具有各个job_id的员工人数</span><br><span class="line">SELECT COUNT(*),job_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY job_id;</span><br></pre></td></tr></table></figure>

<h2 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*</span><br><span class="line">含义：多表查询，当查询的字段来自于多个表时使用</span><br><span class="line">笛卡尔乘积现象：表1 m行，表2 n行，结果m*n行</span><br><span class="line"></span><br><span class="line">原因：没有有效的连接条件</span><br><span class="line">避免：添加有效的连接条件</span><br><span class="line"></span><br><span class="line">分类：</span><br><span class="line">			1.按年代分类：</span><br><span class="line">			sql92标准：在mysql中仅仅支持内连接，在oracle等中支持部分外连接</span><br><span class="line">			sql99标准（推荐）：支持内连接+外连接（左、右）+交叉连接</span><br><span class="line">			</span><br><span class="line">			2.按功能分类：</span><br><span class="line">			内连接：</span><br><span class="line">							等值连接</span><br><span class="line">							非等值连接</span><br><span class="line">							自连接</span><br><span class="line">			外连接：</span><br><span class="line">							左外连接</span><br><span class="line">							右外连接</span><br><span class="line">							全外连接</span><br><span class="line">			交叉连接</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line">SELECT * FROM beauty;</span><br><span class="line">SELECT * FROM boys;</span><br><span class="line"></span><br><span class="line">SELECT name, boyName FROM beauty ,boys; </span><br><span class="line"></span><br><span class="line">SELECT name, boyName FROM beauty ,boys</span><br><span class="line">WHERE beauty.boyfriend_id&#x3D;boys.id;</span><br><span class="line"></span><br><span class="line">#一、sql92标准</span><br><span class="line"></span><br><span class="line">#1.等值连接</span><br><span class="line">&#x2F;*</span><br><span class="line">a.多表等值连接为交集部分</span><br><span class="line">b.n表连接，至少要n-1个连接条件</span><br><span class="line">c.顺序无要求</span><br><span class="line">d.一般要起别名</span><br><span class="line">e.可以搭配排序、分组、筛选</span><br><span class="line">*&#x2F;</span><br><span class="line">#case 1</span><br><span class="line">SELECT name, boyName FROM beauty ,boys</span><br><span class="line">WHERE beauty.boyfriend_id&#x3D;boys.id;</span><br><span class="line"></span><br><span class="line">#case 2:查询员工名和对应的部门名</span><br><span class="line">SELECT last_name,department_name </span><br><span class="line">FROM employees,departments</span><br><span class="line">WHERE employees.department_id&#x3D;departments.department_id;</span><br><span class="line"></span><br><span class="line">#2.为表起别名</span><br><span class="line">#case 查询员工名、工种号、工种名</span><br><span class="line">SELECT last_name,e.job_id,job_title #不知道job_id的来源。需要用表名限定</span><br><span class="line">FROM employees e,jobs j</span><br><span class="line">WHERE e.job_id&#x3D;j.job_id;   #如果起别名就全部要用，统一</span><br><span class="line"></span><br><span class="line">#3.两个表的顺序可以调换</span><br><span class="line">SELECT last_name,e.job_id,job_title #用一个表一行行去对另一个表</span><br><span class="line">FROM jobs j，employees e</span><br><span class="line">WHERE e.job_id&#x3D;j.job_id</span><br><span class="line"></span><br><span class="line">#4.加筛选</span><br><span class="line"># case 1 :查询有奖金的员工名、部门名</span><br><span class="line">SELECT last_name,department_name</span><br><span class="line">FROM employees e, departments d</span><br><span class="line">WHERE e.department_id&#x3D;d.department_id</span><br><span class="line">AND e.commission_pct is not null;</span><br><span class="line"></span><br><span class="line"># case 2:查询城市名中第二个字符为o的部门名和城市名</span><br><span class="line">SELECT city,department_name</span><br><span class="line">FROM departments d, locations l</span><br><span class="line">WHERE d.location_id&#x3D;l.location_id</span><br><span class="line">AND city LIKE &#39;_o%&#39;;</span><br><span class="line"></span><br><span class="line">#5.加分组</span><br><span class="line">#case 1：查询每个城市的部门个数</span><br><span class="line">SELECT COUNT(*) amount ,city</span><br><span class="line">FROM departments d, locations l</span><br><span class="line">WHERE d.location_id&#x3D;l.location_id</span><br><span class="line">GROUP BY city;</span><br><span class="line"></span><br><span class="line">#case 2:查询有奖金的每个部门的部门名和部门领导编号和该部门的最低工资</span><br><span class="line">SELECT d.department_name, d.manager_id,min(salary)</span><br><span class="line">FROM departments d,employees e</span><br><span class="line">WHERE d.department_id&#x3D;e.department_id</span><br><span class="line">AND commission_pct is NOT NULL</span><br><span class="line">GROUP BY e.department_id,d.manager_id;</span><br><span class="line"></span><br><span class="line">#6.加排序</span><br><span class="line">#案例：查询每个工种的工种名和员工的个数，按员工个数降序</span><br><span class="line">SELECT job_title, COUNT(*)</span><br><span class="line">FROM jobs j,employees e</span><br><span class="line">WHERE j.job_id&#x3D;e.job_id</span><br><span class="line">GROUP BY job_title</span><br><span class="line">ORDER BY COUNT(*) DESC;</span><br><span class="line"></span><br><span class="line">#7.三表连接</span><br><span class="line">#case 1： 查询员工名、部门名、所在的城市</span><br><span class="line"></span><br><span class="line">SELECT last_name,department_name,city</span><br><span class="line">FROM employees e, departments d, locations l</span><br><span class="line">WHERE e.department_id&#x3D;d.department_id</span><br><span class="line">AND d.location_id&#x3D;l.location_id;</span><br><span class="line"></span><br><span class="line">#2.非等值连接</span><br><span class="line">#case 1：查询员工的工资和工资级别</span><br><span class="line">SELECT salary,grade_level</span><br><span class="line">FROM employees e, job_grades g</span><br><span class="line">WHERE salary BETWEEN lowest_sal and highest_sal</span><br><span class="line">AND grade_level&#x3D;&#39;A&#39;;</span><br><span class="line"></span><br><span class="line">#3.自连接</span><br><span class="line">#case：查询员工名和上级的名称</span><br><span class="line">SELECT e.last_name,e.employee_id,m.last_name</span><br><span class="line">FROM employees e,employees m </span><br><span class="line">WHERE m.employee_id&#x3D;e.manager_id;</span><br><span class="line"></span><br><span class="line">#显示员工表的最大工资，工资平均值</span><br><span class="line">SELECT MAX(salary),AVG(salary)</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">#查询 员工表的job_id中包含a和e，a在前</span><br><span class="line">SELECT job_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE job_id like &#39;%a%e%&#39;</span><br><span class="line"></span><br><span class="line">#Exercise</span><br><span class="line"></span><br><span class="line">#1. 显示所有员工的姓名，部门号和部门名称。 </span><br><span class="line">SELECT last_name,e.department_id,department_name</span><br><span class="line">FROM employees e,departments d</span><br><span class="line">WHERE e.department_id&#x3D;d.department_id;</span><br><span class="line"></span><br><span class="line">#2. 查询 90 号部门员工的 job_id 和 90 号部门的 location_id </span><br><span class="line">SELECT job_id,location_id,department_id</span><br><span class="line">FROM employees e, locations l</span><br><span class="line">WHERE department_id&#x3D;90 ;  #不用连接条件会产生笛卡尔乘积问题</span><br><span class="line">*-----------------------</span><br><span class="line">SELECT job_id,location_id,e.department_id</span><br><span class="line">FROM employees e, departments d</span><br><span class="line">WHERE e.department_id&#x3D;90 </span><br><span class="line">AND e.department_id&#x3D;d.department_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3. 选择所有有奖金的员工的 last_name , department_name , location_id , city </span><br><span class="line">SELECT last_name,department_name,l.location_id,city</span><br><span class="line">FROM employees e,departments d,locations l</span><br><span class="line">WHERE commission_pct is not null</span><br><span class="line">AND e.department_id&#x3D;d.department_id</span><br><span class="line">AND d.location_id&#x3D;l.location_id;</span><br><span class="line"></span><br><span class="line">#4. 选择city在Toronto工作的员工的 last_name , job_id , department_id , department_name</span><br><span class="line">SELECT last_name,job_id,e.department_id,department_name,city</span><br><span class="line">FROM employees e,departments d,locations l</span><br><span class="line">WHERE city&#x3D;&#39;Toronto&#39;</span><br><span class="line">AND e.department_id&#x3D;d.department_id</span><br><span class="line">AND d.location_id&#x3D;l.location_id;   #三表连接，要写两个条件</span><br><span class="line"> </span><br><span class="line">#5.查询每个工种、每个部门的部门名、工种名和最低工资 </span><br><span class="line">SELECT j.job_id,department_name,job_title,MIN(salary)</span><br><span class="line">FROM jobs j, departments d,employees e</span><br><span class="line">WHERE j.job_id&#x3D;e.job_id</span><br><span class="line">AND e.department_id&#x3D;d.department_id</span><br><span class="line">GROUP BY job_id;</span><br><span class="line"></span><br><span class="line">#6.查询每个国家下的部门个数大于 2 的国家编号 </span><br><span class="line">SELECT country_id, department_id,count(*)</span><br><span class="line">FROM locations l,departments d</span><br><span class="line">WHERE l.location_id&#x3D;d.location_id</span><br><span class="line">GROUP BY country_id</span><br><span class="line">HAVING count(*)&gt;2;</span><br><span class="line">#7.择指定员工的姓名，员工号，以及他的管理者的姓名和员工号，结果类似于下面的格 式 </span><br><span class="line">&#x2F;*</span><br><span class="line">employees Emp# manager Mgr# </span><br><span class="line">kochhar   101  king    100 </span><br><span class="line">*&#x2F;</span><br><span class="line">SELECT e.last_name employees,e.employee_id &#39;Emp#&#39;,m.last_name manager,m.employee_id &#39;Mgr#&#39;</span><br><span class="line">FROM employees e, employees m</span><br><span class="line">WHERE e.manager_id&#x3D;m.employee_id</span><br><span class="line">AND e.employee_id&#x3D;101;</span><br></pre></td></tr></table></figure>



<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#进阶7：子查询</span><br><span class="line">&#x2F;* </span><br><span class="line"></span><br><span class="line">含义：出现在其他语句内部的Select语句，称为子查询或内查询</span><br><span class="line">查询的嵌套，外部的就是外查询（主查询）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">分类</span><br><span class="line">按子查询出现的位置：</span><br><span class="line">			  SELECT :仅支持标量子查询</span><br><span class="line">			  FROM    支持表只查询</span><br><span class="line">（重点）WHERE&#x2F;HAVING  标量子查询 列子查询 行子查询</span><br><span class="line">				EXISTS （相关子查询（ 表子查询</span><br><span class="line">按结果集的行列数不同：</span><br><span class="line">		标量子查询：结果集只有一行一列</span><br><span class="line">		列子查询  一列多行</span><br><span class="line">		行子查询  一行多列</span><br><span class="line">		表子查询  多行多列</span><br><span class="line">			</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#一、WHERE或HAVING后</span><br><span class="line">-- 1、标量子查询 单行</span><br><span class="line">-- 2、列子查询  一列多行</span><br><span class="line">-- </span><br><span class="line">-- 3、特点：</span><br><span class="line">-- 子查询放在小括号内</span><br><span class="line">-- 子查询一般放在条件的右侧</span><br><span class="line">-- 标量子查询，一般搭配单行操作符使用 ，如 &gt; &lt; &#x3D; &lt;&gt;</span><br><span class="line">-- </span><br><span class="line">-- 列子查询 一般搭配多行操作符使用  in any&#x2F;some all</span><br><span class="line">-- 4、子查询是优先于主查询进行的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 案例1：谁的工资比Abel高？</span><br><span class="line"># 查询出子查询</span><br><span class="line">SELECT salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE last_name &#x3D; &#39;Abel&#39;</span><br><span class="line"></span><br><span class="line">#作为主查询的条件</span><br><span class="line">SELECT * </span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary &gt; (</span><br><span class="line">				SELECT salary</span><br><span class="line">				FROM employees</span><br><span class="line">				WHERE last_name &#x3D; &#39;Abel&#39;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#案例2 返回job_id与141员工相同，salary比143员工多的员工 的姓名 job_id 和工资</span><br><span class="line">SELECT job_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE employee_id &#x3D;141;</span><br><span class="line"></span><br><span class="line">SELECT salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE employee_id &#x3D; 143;</span><br><span class="line"></span><br><span class="line">SELECT last_name,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary &gt; (</span><br><span class="line">			SELECT salary</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE employee_id &#x3D; 143</span><br><span class="line"></span><br><span class="line">) AND job_id &#x3D; </span><br><span class="line">(</span><br><span class="line">			SELECT job_id</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE employee_id &#x3D;141</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#案例3 返回工资最少的员工的 last_name job_id salary</span><br><span class="line"></span><br><span class="line">SELECT last_name,job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary &#x3D; (</span><br><span class="line">			SELECT MIN(salary)</span><br><span class="line">			FROM employees</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例4 查询最低工资大于50号部门最低工资的部门id和其最低工资</span><br><span class="line">#选出每个部门的最低工资，大于子查询中 50号部门的最低工资</span><br><span class="line"></span><br><span class="line">SELECT MIN(salary),department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line">HAVING MIN(salary)&gt;(</span><br><span class="line">			SELECT MIN(salary)</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE department_id &#x3D; 50</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">#非法使用标量子查询</span><br><span class="line">SELECT MIN(salary),department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line">HAVING MIN(salary)&gt;(</span><br><span class="line">			SELECT salary    #内部是个列子查询  多个值，没法比较</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE department_id &#x3D; 50</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2、多行子查询(列子查询)  搭配多行比较操作符  一列多行</span><br><span class="line">IN &#x2F;NOT IN     等于列表中任意一个</span><br><span class="line">ANY &#x2F; SOME		和子查询返回的某一个值比较    使用较少 会使用MIN MAX等代替</span><br><span class="line">ALL						和子查询返回的所有值比较      也可以替换为MIN MAX</span><br><span class="line"></span><br><span class="line">#案例1 返回location_id是1400或1700部门中所有的员工姓名</span><br><span class="line"></span><br><span class="line">#只要先查出1400 1700的部门编号就行，不用连接查询</span><br><span class="line">SELECT last_name </span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id IN(   #IN 可以替换成 &#x3D; ANY   &#x2F;  NOT IN  可以替换成 &lt;&gt;ALL</span><br><span class="line">			SELECT DISTINCT department_id  #最好去重</span><br><span class="line">			FROM departments</span><br><span class="line">			WHERE location_id IN (1400,1700)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例2 返回其他部门中比  job_id为IT_PROG工种任一工资   低的员工的工号 姓名 jobid 及salary</span><br><span class="line">#都可以是使用min max替代</span><br><span class="line"></span><br><span class="line">SELECT employee_id, last_name, job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary &lt; ANY(</span><br><span class="line">		SELECT DISTINCT salary</span><br><span class="line">		FROM employees</span><br><span class="line">		WHERE job_id &#x3D; &#39;IT_PROG&#39;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#案例3 返回其他部门中比  job_id为IT_PROG工种所有工资   低的员工的工号 姓名 jobid 及salary</span><br><span class="line"></span><br><span class="line">SELECT employee_id, last_name, job_id,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary &lt; ALL(</span><br><span class="line">		SELECT salary</span><br><span class="line">		FROM employees</span><br><span class="line">		WHERE job_id &#x3D; &#39;IT_PROG&#39;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3、行子查询（一行多列或者多行多列）   用的相对列子查询少</span><br><span class="line"></span><br><span class="line">#案例 查询员工编号最小且工资最高的员工信息</span><br><span class="line">#不一定存在，也可以使用上面的列子查询的 AND来做，效果是一致的</span><br><span class="line">SELECT * </span><br><span class="line">FROM employees</span><br><span class="line">WHERE (employee_id,salary) &#x3D; (   #两个条件都放在小括号里，将多个字段当做一个虚拟的字段</span><br><span class="line">		SELECT MIN(employee_id),MAX(salary)</span><br><span class="line">		FROM employees</span><br><span class="line">);		</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、SELECT 后面  只能一行一列</span><br><span class="line"></span><br><span class="line"># 案例查询每个部门的员工个数 </span><br><span class="line">#和连接的效果一样</span><br><span class="line">SELECT d.*,(</span><br><span class="line">			SELECT COUNT(*)</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE e.department_id &#x3D; d.department_id</span><br><span class="line">			)</span><br><span class="line">FROM departments d;</span><br><span class="line"></span><br><span class="line">#查询员工号 102的部门名</span><br><span class="line"></span><br><span class="line">SELECT (</span><br><span class="line">		SELECT department_name</span><br><span class="line">		FROM departments d</span><br><span class="line">		INNER JOIN employees e</span><br><span class="line">		ON e.department_id &#x3D; d.department_id</span><br><span class="line">		WHERE employee_id &#x3D; 102</span><br><span class="line">		) 部门名;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、FROM后面</span><br><span class="line">#案例：查询每个部门的平均工资的工资等级</span><br><span class="line"></span><br><span class="line">SELECT AVG(salary),department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT ags.* ,grade_level</span><br><span class="line">FROM (</span><br><span class="line">		SELECT AVG(salary) ag,department_id</span><br><span class="line">		FROM employees</span><br><span class="line">		GROUP BY department_id) ags   #必须起别名，因为该表没有名字</span><br><span class="line">INNER JOIN job_grades j</span><br><span class="line">ON ags.ag BETWEEN lowest_sal AND highest_sal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#四、exsits后面 相关子查询  boolean 子查询是不是有值 ,1为true</span><br><span class="line">&#x2F;*</span><br><span class="line">exsits(完整的查询语句）</span><br><span class="line">返回1,0</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">SELECT EXISTS(SELECT employee_id FROM employees);</span><br><span class="line"></span><br><span class="line">#查询有员工的部门名</span><br><span class="line">SELECT department_name</span><br><span class="line">FROM departments d</span><br><span class="line">WHERE EXISTS(   #类似一个filter</span><br><span class="line">		SELECT employee_id </span><br><span class="line">		FROM employees e</span><br><span class="line">		WHERE d.department_id &#x3D; e.department_id   #如果不加这句，就变成全选了，全都返回true</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">SELECT department_name</span><br><span class="line">FROM departments d</span><br><span class="line">WHERE d.department_id IN(</span><br><span class="line">		SELECT department_id</span><br><span class="line">		FROM employees  #凡是有部门的员工 都有其对应的部门编号</span><br><span class="line">		#WHERE employee_id IS NOT NULL</span><br><span class="line">		)</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT * FROM boys   #boys. 前缀要加就都加</span><br><span class="line">WHERE id NOT IN(</span><br><span class="line">		SELECT boyfriend_id</span><br><span class="line">		FROM beauty</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">-- 1. 查询和 Zlotkey 相同部门的员工姓名和工资 </span><br><span class="line">SELECT last_name,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id &#x3D; (</span><br><span class="line">			SELECT department_id</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE last_name &#x3D; &#39;Zlotkey&#39;</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line">-- 2. 查询工资比公司平均工资高的员工的员工号，姓名和工资。 </span><br><span class="line"></span><br><span class="line">SELECT employee_id,last_name,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line">			SELECT AVG(salary)</span><br><span class="line">			FROM employees</span><br><span class="line">			);</span><br><span class="line">			</span><br><span class="line">-- 3. 查询各部门中工资比本部门平均工资高的员工的员工号, 姓名和工资 </span><br><span class="line">SELECT employee_id,last_name,salary,e.department_id,avs.ag</span><br><span class="line">FROM employees	e</span><br><span class="line"> JOIN (    #INNER 可以省略 复习一下连接查询</span><br><span class="line">			SELECT AVG(salary) ag,department_id</span><br><span class="line">			FROM employees</span><br><span class="line">			GROUP BY department_id</span><br><span class="line">			) as avs  #这里要加分号的</span><br><span class="line">ON e.department_id &#x3D; avs.department_id	</span><br><span class="line">WHERE e.salary&gt;avs.ag;  #分组才用having</span><br><span class="line"></span><br><span class="line">-- 4. 查询和姓名中包含字母 u 的员工在相同部门的  员工的员工号和姓名 </span><br><span class="line">SELECT employee_id,last_name</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id IN(</span><br><span class="line">			SELECT DISTINCT department_id</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE last_name LIKE &#39;%u%&#39;  #不要写成is like</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line">-- 5.  查询在部门的 location_id 为 1700 的部门工作的员工的员工号</span><br><span class="line">SELECT employee_id</span><br><span class="line">FROM employees</span><br><span class="line">WHERE department_id IN (</span><br><span class="line">			SELECT department_id</span><br><span class="line">			FROM departments</span><br><span class="line">			WHERE location_id &#x3D;1700</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 6.  查询管理者是 K_ing 的员工姓名和工资 </span><br><span class="line"></span><br><span class="line">SELECT last_name,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE manager_id IN (</span><br><span class="line">			SELECT employee_id</span><br><span class="line">			FROM employees</span><br><span class="line">			WHERE last_name &#x3D; &#39;K_ing&#39;</span><br><span class="line">			);</span><br><span class="line">			</span><br><span class="line">-- 7.  查询工资最高的员工的姓名，要求 first_name 和 last_name 显示为一列，列名为 姓.名 </span><br><span class="line">SELECT CONCAT(first_name,last_name) &#39;姓名&#39;</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary &#x3D; (</span><br><span class="line">		SELECT MAX(salary)</span><br><span class="line">		FROM employees</span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">#子查询案例	</span><br><span class="line">-- 		 1. 查询工资最低的员工信息: last_name, salary  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 		 2. 查询平均工资最低的部门信息 </span><br><span class="line"></span><br><span class="line">#和分组函数的一起查询字段的也是分组的后的</span><br><span class="line"></span><br><span class="line">SELECT d.* </span><br><span class="line">FROM departments d  </span><br><span class="line">JOIN (</span><br><span class="line">		SELECT AVG(salary) avgsal,department_id</span><br><span class="line">		FROM employees</span><br><span class="line">		GROUP BY department_id</span><br><span class="line">		) avs</span><br><span class="line">ON d.department_id &#x3D; avs .department_id</span><br><span class="line">ORDER BY avs.avgsal</span><br><span class="line">LIMIT 1;</span><br><span class="line">		</span><br><span class="line">-- 		 3. 查询平均工资最低的部门信息和该部门的平均工资  </span><br><span class="line">SELECT d.*,avs.avgsal</span><br><span class="line">FROM departments d</span><br><span class="line">JOIN (</span><br><span class="line">		SELECT AVG(salary) avgsal,department_id</span><br><span class="line">		FROM employees</span><br><span class="line">		GROUP BY department_id</span><br><span class="line">		) avs</span><br><span class="line">ON d.department_id &#x3D; avs .department_id</span><br><span class="line">ORDER BY avs.avgsal</span><br><span class="line">LIMIT 1;</span><br><span class="line"></span><br><span class="line">-- 		 4. 查询平均工资最高的 job 信息 </span><br><span class="line">SELECT j.*</span><br><span class="line">FROM jobs j</span><br><span class="line">JOIN (</span><br><span class="line">			SELECT AVG(salary) avs,job_id</span><br><span class="line">			FROM employees</span><br><span class="line">			GROUP BY job_id</span><br><span class="line">			</span><br><span class="line">) maxj</span><br><span class="line">ON maxj.job_id &#x3D; j.job_id</span><br><span class="line">ORDER BY maxj.avs DESC</span><br><span class="line">LIMIT 1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 		 5. 查询平均工资高于公司平均工资的部门有哪些? </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT department_name,avg.asgs</span><br><span class="line">FROM departments d</span><br><span class="line">INNER JOIN</span><br><span class="line">(SELECT AVG(salary) asgs,department_id</span><br><span class="line">	FROM employees</span><br><span class="line">	GROUP BY department_id</span><br><span class="line">	</span><br><span class="line">	) as avg</span><br><span class="line">ON avg.department_id &#x3D; d.department_id  #存在department_id为null的员工</span><br><span class="line"></span><br><span class="line">WHERE avg.asgs&gt; (</span><br><span class="line">		SELECT AVG(salary) FROM employees</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">-- 		 6. 查询出公司中所有 manager 的详细信息.  </span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM employees</span><br><span class="line">WHERE employee_id IN (</span><br><span class="line">		SELECT DISTINCT manager_id</span><br><span class="line">		FROM employees</span><br><span class="line">		);</span><br><span class="line">-- 		 7. 各个部门中 最高工资中最低的那个部门的 最低工资是多少 </span><br><span class="line"></span><br><span class="line">SELECT MIN(m.maxsal)</span><br><span class="line">FROM(</span><br><span class="line">		SELECT MAX(salary) maxsal</span><br><span class="line">		FROM employees</span><br><span class="line">		GROUP BY department_id</span><br><span class="line">) m;</span><br><span class="line"></span><br><span class="line">-- 		 8. 查询平均工资最高的部门的 manager 的详细信息: last_name, department_id, email, salary </span><br><span class="line">SELECT last_name,e.department_id,email,salary</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN departments d</span><br><span class="line">ON d.manager_id &#x3D; e.employee_id</span><br><span class="line">WHERE e.department_id &#x3D; (</span><br><span class="line"></span><br><span class="line">		SELECT department_id</span><br><span class="line">		FROM employees</span><br><span class="line">		GROUP BY department_id</span><br><span class="line">		ORDER BY AVG(salary) DESC</span><br><span class="line">		limit 1</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--</span><br></pre></td></tr></table></figure>

<h2 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#进阶8 分页查询  重要</span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">应用场景：当要显示的数据一页显示不全，需要分页提交sql请求</span><br><span class="line">语法：SELECT  查询列表</span><br><span class="line">			FROM table1</span><br><span class="line">			【连接类型 JOIN table2</span><br><span class="line">			ON 连接条件</span><br><span class="line">			WHERE  筛选条件</span><br><span class="line">			GROUP BY 分组字段</span><br><span class="line">			HAVING  分组后的筛选</span><br><span class="line">			ORDER BY 排序的字段】</span><br><span class="line">			LIMIT OFFSET,SIZE   分页查询</span><br><span class="line">			</span><br><span class="line">			offset：要显示条目的起始索引，起始索引是0</span><br><span class="line">			size：显示条目个数</span><br><span class="line">			</span><br><span class="line">特点：limit语句在查询语句的最后</span><br><span class="line">			公式 显示的页数page 每页的条目size</span><br><span class="line">			SELECT </span><br><span class="line">			FROM</span><br><span class="line">			LIMIT (page-1)*size ,size;</span><br><span class="line">*&#x2F;</span><br><span class="line">#案例1 查询前五条员工信息</span><br><span class="line"></span><br><span class="line">SELECT * FROM employees LIMIT 0,5;</span><br><span class="line">SELECT * FROM employees LIMIT 5;#从0开始可以简写</span><br><span class="line"></span><br><span class="line">#案例2 查询11-25条员工信息</span><br><span class="line">SELECT * FROM employees LIMIT 10,15;</span><br><span class="line"></span><br><span class="line">#案例3 有奖金，工资前十名</span><br><span class="line">SELECT *</span><br><span class="line">FROM employees</span><br><span class="line">WHERE commission_pct IS NOT NULL</span><br><span class="line">ORDER BY salary DESC</span><br><span class="line">LIMIT 10;</span><br></pre></td></tr></table></figure>

<h2 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#进阶9 联合查询</span><br><span class="line">&#x2F;*</span><br><span class="line">UNION 将多条查询语句的结果合并成一个结果</span><br><span class="line"></span><br><span class="line">格式：</span><br><span class="line">SELECT * FROM employees WHERE email LIKE &#39;%a%&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT * FROM employees WHERE department_id &gt;90</span><br><span class="line">UNION</span><br><span class="line">...;</span><br><span class="line"></span><br><span class="line">应用场景：</span><br><span class="line">当涉及查多个表的时候，且没有连接关系，但是查的要素是一样的，</span><br><span class="line">可以拆分查询，然后合成一个查询结果</span><br><span class="line"></span><br><span class="line">特点：</span><br><span class="line">1、多个查询语句查询的列数必须是一致的</span><br><span class="line">2、字段名是第一条查询的字段名，所以要求多条查询的每一列类型和顺序是一致的</span><br><span class="line">3、如果多个表中存在完全相同的数据，会去重。如需不去重 使用UNION ALL</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#查询部门编号&gt;90 或邮箱含a的员工信息</span><br><span class="line">SELECT * FROM employees WHERE email LIKE &#39;%a%&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT * FROM employees WHERE department_id &gt;90;</span><br></pre></td></tr></table></figure>

<h1 id="DML-增删改"><a href="#DML-增删改" class="headerlink" title="DML 增删改"></a>DML 增删改</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"># DATA MANIPULATE LANGUAGE</span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">INSERT 插</span><br><span class="line">UPDATE 改</span><br><span class="line">DELETE 删</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#一、插入语句</span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">方式一  用的多</span><br><span class="line">语法：</span><br><span class="line">INSERT INTO 表名(列名,...) VALUES(值...)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#1.插入值的类型要与列的类型一致或兼容</span><br><span class="line">INSERT INTO beauty(id,&#96;name&#96;,sex，borndate,phone,phone,boyfriend_id)</span><br><span class="line">VALUES(15,&#39;lucy&#39;,&#39;female&#39;,&#39;1999-1-1&#39;,&#39;18988898889&#39;,NULL,1)</span><br><span class="line"></span><br><span class="line">#2.不可以为null的列必须插入值。可以为null的列可以插入null，或者</span><br><span class="line">#字段和value都不写，会填入默认值，未设置默认值的就会填充null</span><br><span class="line"></span><br><span class="line">#3.列的顺序可以随意，但值要一一对应</span><br><span class="line"></span><br><span class="line">#4.列数和值得个数一定要一致</span><br><span class="line"></span><br><span class="line">#5.可以省略列名，默认为所有列的默认顺序</span><br><span class="line">INSERT INTO beauty</span><br><span class="line">VALUES(16,&#39;jessie&#39;,&#39;female&#39;,&#39;1999-1-1&#39;,&#39;18988898889&#39;,NULL,2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">方式二</span><br><span class="line">语法：</span><br><span class="line">INSERT INTO 表名</span><br><span class="line">SET 列名 &#x3D; 值，列名 &#x3D; 值，...</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line">INSERT INTO beauty </span><br><span class="line">SET id &#x3D; 20,name &#x3D; &#39;bope&#39;,phone &#x3D; &#39;3123&#39;;</span><br><span class="line"></span><br><span class="line">#比较</span><br><span class="line"></span><br><span class="line">#1.方式一支持插入多行</span><br><span class="line">INSERT INTO beauty</span><br><span class="line">VALUES(17,&#39;jessie&#39;,&#39;f&#39;,&#39;1999-1-1&#39;,&#39;1898889888&#39;,NULL,2),</span><br><span class="line">(18,&#39;jessie2&#39;,&#39;f&#39;,&#39;1999-1-2&#39;,&#39;1898889288&#39;,NULL,2);</span><br><span class="line"></span><br><span class="line">#2.方式一支持子查询</span><br><span class="line">INSERT INTO beauty(id,name,phone)</span><br><span class="line">SELECT 23,&#39;joe&#39;,&#39;123433&#39;;</span><br><span class="line"></span><br><span class="line">#二、修改语句</span><br><span class="line">&#x2F;*</span><br><span class="line">1.修改单表的记录</span><br><span class="line">语法：</span><br><span class="line">UPDATE 表名</span><br><span class="line">SET 列名 &#x3D; 新值，列名 &#x3D; 新值，...</span><br><span class="line">WHERE 筛选条件;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.修改多表的记录（补充）</span><br><span class="line"></span><br><span class="line">sql92语法：</span><br><span class="line">UPDATE 表名1 别名，表2 别名</span><br><span class="line">SET 列名 &#x3D; 新值，列名 &#x3D; 新值，...</span><br><span class="line">WHERE 连接条件</span><br><span class="line">AND 筛选条件;</span><br><span class="line"></span><br><span class="line">sql99语法：</span><br><span class="line">UPDATE 表名1 别名</span><br><span class="line">xxxJOIN 表2 别名</span><br><span class="line">ON 连接条件</span><br><span class="line">SET 列名 &#x3D; 新值，列名 &#x3D; 新值，...</span><br><span class="line">WHERE 筛选条件;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line">#1.修改单表的记录</span><br><span class="line"></span><br><span class="line">#案例1 修改 姓唐的 电话为&#39;&#39;</span><br><span class="line">UPDATE beauty</span><br><span class="line">SET phone &#x3D; &#39;23123213&#39;</span><br><span class="line">WHERE NAME LIKE &#39;j%&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例1 修改 boys id2 的名称和userC</span><br><span class="line">UPDATE boys SET boyName &#x3D; &#39;jack&#39;,userCP &#x3D; 100</span><br><span class="line">WHERE id &#x3D; 1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.修改多表的记录</span><br><span class="line">#案例2 </span><br><span class="line">UPDATE boys bo</span><br><span class="line">INNER JOIN beauty b</span><br><span class="line">ON bo.id &#x3D; b.boyfriend_id</span><br><span class="line">SET phone &#x3D; &#39;123132&#39;</span><br><span class="line">WHERE boyName &#x3D; &#39;jack&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">UPDATE boys bo</span><br><span class="line">RIGHT JOIN beauty b </span><br><span class="line">ON bo.id &#x3D; b.boyfriend_id</span><br><span class="line">SET b.boyfriend_id &#x3D; 2</span><br><span class="line">WHERE b.boyfriend_id IS NULL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、删除语句</span><br><span class="line">&#x2F;*</span><br><span class="line">方式一：DELETE</span><br><span class="line">语法：</span><br><span class="line">1.单表的删除</span><br><span class="line">DELETE FROM 表名 WHERE 筛选条件;</span><br><span class="line"></span><br><span class="line">2.多表的删除</span><br><span class="line">sql92语法</span><br><span class="line">DELETE  表1别名，【表2别名】</span><br><span class="line">FROM 表1 别名，表2 别名</span><br><span class="line">WHERE 连接条件</span><br><span class="line">AND  筛选条件</span><br><span class="line"></span><br><span class="line">sql99</span><br><span class="line">DELETE  表1别名，【表2别名】</span><br><span class="line">FROM 表1</span><br><span class="line">xxxJOIN 表2  ON 连接条件</span><br><span class="line">WHERE 筛选条件</span><br><span class="line"></span><br><span class="line">方式二：TRUNCATE</span><br><span class="line">语法：</span><br><span class="line">TRUNCATE TABLE 表名；</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#方式一：DELETE</span><br><span class="line">#单表</span><br><span class="line">DELETE FROM beauty WHERE phone LIKE &#39;%9&#39;;</span><br><span class="line"></span><br><span class="line">#多表删除，同多表update，按需要删除某个表或多个表的元素</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#方式二：TRUNCATE,不能使用where</span><br><span class="line"></span><br><span class="line">TRUNCATE TABLE boys;  #清空</span><br><span class="line"></span><br><span class="line">#区别</span><br><span class="line">&#x2F;*</span><br><span class="line">1.delete可以加where</span><br><span class="line">2.truncate 效率略高</span><br><span class="line">3.如果使用delete，再insert，自增长列(id自增长）的值从断点开始</span><br><span class="line"> truncate则从1开始</span><br><span class="line">4.truncate没有返回值 DELETE会返回 affected rows: int</span><br><span class="line"></span><br><span class="line">5.truncate删除不可以回滚，DELETE可以回滚</span><br><span class="line">*&#x2F;</span><br></pre></td></tr></table></figure>

<h1 id="DDL-库表"><a href="#DDL-库表" class="headerlink" title="DDL 库表"></a>DDL 库表</h1><h2 id="库表操作"><a href="#库表操作" class="headerlink" title="库表操作"></a>库表操作</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">#DDL DATA DEFINE LANGUAGE</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">库和表的管理</span><br><span class="line"></span><br><span class="line">一、库的管理</span><br><span class="line">创建、修改、删除</span><br><span class="line"></span><br><span class="line">二、表的管理</span><br><span class="line">创建、修改、删除</span><br><span class="line"></span><br><span class="line">三、关键字</span><br><span class="line">create alter drop</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#一、库的管理</span><br><span class="line">#1.创建库</span><br><span class="line">CREATE DATABASE IF NOT EXISTS books;</span><br><span class="line"></span><br><span class="line">#2.修改库  一般不修改</span><br><span class="line">#更改字符集</span><br><span class="line">ALTER DATABASE books CHARACTER SET gbk;</span><br><span class="line"></span><br><span class="line">#3.删库</span><br><span class="line">DROP DATABASE IF EXISTS books;</span><br><span class="line">CREATE DATABASE IF NOT EXISTS books;</span><br><span class="line"></span><br><span class="line">#二、表的管理</span><br><span class="line">#1、表的创建</span><br><span class="line">&#x2F;*</span><br><span class="line">CREATE TABLE 表名(</span><br><span class="line">		列名 列类型【（长度）约束】,</span><br><span class="line">		列名 列类型【（长度）约束】,</span><br><span class="line">		列名 列类型【（长度）约束】,</span><br><span class="line">		...</span><br><span class="line">		列名 列类型【（长度）约束】</span><br><span class="line">		)</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">CREATE TABLE book(</span><br><span class="line">				id INT,</span><br><span class="line">				bookName VARCHAR(20),</span><br><span class="line">				price DOUBLE,</span><br><span class="line">				authorID INT,</span><br><span class="line">				publishDate INT </span><br><span class="line">				</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC book;</span><br><span class="line"></span><br><span class="line">CREATE TABLE AUTHOR(</span><br><span class="line">			id INT,</span><br><span class="line">			au_name VARCHAR(20),</span><br><span class="line">			nation VARCHAR(20)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#2、表的修改</span><br><span class="line"></span><br><span class="line">#ALTER TABLE 表名 CHANGE&#x2F;MODIFY&#x2F;ADD&#x2F;DROP COLUMN 列名 列类型 约束;</span><br><span class="line">#1.修改列名</span><br><span class="line">ALTER TABLE book CHANGE COLUMN publishDate pubDate TIMESTAMP;</span><br><span class="line">#需要加上类型</span><br><span class="line"></span><br><span class="line">#2.修改列类型或约束</span><br><span class="line">ALTER TABLE book MODIFY COLUMN pubDate TIMESTAMP;</span><br><span class="line"></span><br><span class="line">#3.添加新列</span><br><span class="line">ALTER TABLE author ADD COLUMN annual DOUBLE;</span><br><span class="line"></span><br><span class="line">#4.删除列</span><br><span class="line">ALTER TABLE author DROP COLUMN annual;</span><br><span class="line">#5.修改表名</span><br><span class="line"></span><br><span class="line">ALTER TABLE author RENAME TO bookauthor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3、表的删除</span><br><span class="line">&#x2F;*</span><br><span class="line">*&#x2F;</span><br><span class="line">DROP TABLE IF EXISTS book_author;</span><br><span class="line">SHOW TABLE;</span><br><span class="line"></span><br><span class="line">#4、表的复制</span><br><span class="line"></span><br><span class="line">INSERT INTO author VALUES</span><br><span class="line">(1,&#39;a&#39;,&#39;japan&#39;),</span><br><span class="line">(2,&#39;b&#39;,&#39;japan&#39;),</span><br><span class="line">(3,&#39;c&#39;,&#39;japan&#39;),</span><br><span class="line">(4,&#39;d&#39;,&#39;china&#39;);</span><br><span class="line"> </span><br><span class="line"> #1.仅复制表的结构</span><br><span class="line">CREATE TABLE copyOfAuthor LIKE author;  </span><br><span class="line">SELECT * FROM author;</span><br><span class="line">SELECT * FROM copyOfAuthor;</span><br><span class="line"></span><br><span class="line"> #2.复制表的 结构+数据</span><br><span class="line">CREATE TABLE copyOfAuthor1</span><br><span class="line">SELECT * FROM author;</span><br><span class="line">SELECT * FROM copyOfAuthor1;</span><br><span class="line"></span><br><span class="line">#3.复制表的 结构+部分数据</span><br><span class="line">CREATE TABLE copyOfAuthor2</span><br><span class="line">SELECT id,au_name FROM author</span><br><span class="line">WHERE nation &#x3D; &#39;japan&#39;;</span><br><span class="line"></span><br><span class="line">#4.复制表的 部分结构</span><br><span class="line">CREATE TABLE copyOfAuthor3</span><br><span class="line">SELECT id,au_name FROM author</span><br><span class="line">WHERE 0;</span><br></pre></td></tr></table></figure>

<h2 id="常见的数据类型"><a href="#常见的数据类型" class="headerlink" title="常见的数据类型"></a>常见的数据类型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">#常见的数据类型</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">数值型</span><br><span class="line">			整型</span><br><span class="line">			小数： 定点数  DEC(M,D)</span><br><span class="line">						浮点数 FLOAT(M,D) DOUBLE(M,D)</span><br><span class="line">字符型</span><br><span class="line">			较短的文本：char varchar</span><br><span class="line">			较长的文本：text blob（binary large object）</span><br><span class="line">			</span><br><span class="line">日期型：			</span><br><span class="line"></span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#一、整型 TINYINT(8bit) SMALLINT(2byte) MEDIUMINT(3byte) INT&#x2F;INTEGER(4byte) BIGINT(8byte)</span><br><span class="line">&#x2F;*</span><br><span class="line">#特点：</span><br><span class="line">1.默认是有符号</span><br><span class="line">2.超出范围，默认插入临界值  out of range</span><br><span class="line">3.如果不设置长度，会有默认的长度,长度为显示的宽度，ZEROFILL会用0填充</span><br><span class="line">*&#x2F;</span><br><span class="line">#1.如何设置无符号和有符号</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_int(</span><br><span class="line">	t1 INT(7) ZEROFILL, #而且默认变成无符号</span><br><span class="line">	t2 INT UNSIGNED #无符号</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int </span><br><span class="line">SET t1 &#x3D; 123,</span><br><span class="line">t2 &#x3D; 123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- #二、小数</span><br><span class="line">&#x2F;*</span><br><span class="line">DEC(M,D)</span><br><span class="line">FLOAT(M,D) DOUBLE(M,D)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># </span><br><span class="line">1.M 整数+小数长度  D保留D位小数</span><br><span class="line">2.浮点的M D可以省略</span><br><span class="line">3.DEC默认为 DEC(10,0) 不保留小数 四舍五入</span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line">CREATE TABLE tab_float(</span><br><span class="line">	f1 FLOAT(5,2),</span><br><span class="line">	f2 DOUBLE(5,2),</span><br><span class="line">	f3 DEC  #不要逗号</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_float VALUES</span><br><span class="line">(100.00,100.00,100.90);</span><br><span class="line"></span><br><span class="line">#选择简单类型，选择较小的够保存的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、字符型</span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">	较短的文本：</span><br><span class="line">	char(M)    M:字符数 效率略高一些，默认为1可以省略</span><br><span class="line">	varchar(M)  必须声明长度 可变长度，根据存储的数据的长度，开辟存储空间，节省空间</span><br><span class="line">	</span><br><span class="line">	较长的文本：</span><br><span class="line">	text </span><br><span class="line">	blob（binary large object） JDBC</span><br><span class="line">	</span><br><span class="line">	enum型  规定了插入数据 只能是其枚举的类型,大小写不影响,只能是字符</span><br><span class="line">	</span><br><span class="line">	set型  集合,可以插入几个，都在一对&#39;&#39;内</span><br><span class="line">	</span><br><span class="line">	BINARY</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">CREATE TABLE enum(</span><br><span class="line"></span><br><span class="line">		e1 enum(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;)</span><br><span class="line"></span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">INSERT INTO enum VALUES</span><br><span class="line">(&#39;A&#39;)</span><br><span class="line"></span><br><span class="line">CREATE TABLE set1(</span><br><span class="line"></span><br><span class="line">		e1 SET(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;)</span><br><span class="line"></span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">INSERT INTO set1 VALUES</span><br><span class="line">(&#39;a,b&#39;),</span><br><span class="line">(&#39;a&#39;),</span><br><span class="line">(&#39;a,b,c&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#四、日期型</span><br><span class="line">&#x2F;*</span><br><span class="line">DATE  3BYTE</span><br><span class="line">TIME  3</span><br><span class="line">YEAR  1</span><br><span class="line"></span><br><span class="line">DATETIME  8byte   1000-9999</span><br><span class="line">TIMESTAMP 4byte  32位，只能表示2的32次方ms 当前时区</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">CREATE TABLE chronicle(</span><br><span class="line">			c1 DATETIME,</span><br><span class="line">			c2 TIMESTAMP</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO chronicle VALUES</span><br><span class="line">(now(),now());</span><br><span class="line"></span><br><span class="line">SELECT * FROM chronicle;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#39;time_zone&#39;;</span><br><span class="line"></span><br><span class="line">SET time_zone &#x3D; &#39;+9:00&#39;;</span><br></pre></td></tr></table></figure>

<h2 id="常见约束"><a href="#常见约束" class="headerlink" title="常见约束"></a>常见约束</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">#常见约束</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">含义： 一种限制，用于限制表中的数据，为了保证表中的数据的准确性和可靠性</span><br><span class="line"></span><br><span class="line">分类：六种</span><br><span class="line">			NOT NULL 		保证该字段的值不能为空</span><br><span class="line">			DEFAULT 		保证字段有默认值</span><br><span class="line">			PRIMARY KEY 主键 保证该字段的唯一性且非空</span><br><span class="line">			UNIQUE 			保证字段的值唯一，可以为空</span><br><span class="line">			CHECK  			MYSQL不支持 检查性别，检查年龄的范围</span><br><span class="line">			FOREIGN KEY 限制两个表的关系，用于保证该字段的值必须来自主表的关联列的值</span><br><span class="line">			            在从表添加外键约束，引用主表的值</span><br><span class="line">添加约束的时机：</span><br><span class="line">1.创建表时</span><br><span class="line">2.修改表时</span><br><span class="line"></span><br><span class="line">添加分类</span><br><span class="line">		列级约束  语法上都支持，但外键约束没有效果</span><br><span class="line">		表级约束  除了NOT NULL 和DEFAULT</span><br><span class="line"></span><br><span class="line">添加列级约束：</span><br><span class="line">直接在字段类型后面追加 NOT NULL、 DEFAULT、 PRIMARY KEY、 UNIQUE</span><br><span class="line">			</span><br><span class="line">添加表级约束：在字段最后  【CONSTRAINT 约束名】 约束类型(约束字段)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PRIMARY KEY 对比  UNIQUE</span><br><span class="line">1.主键为非空，一个表中至多只有一个</span><br><span class="line">2.UNIQUE只能有一个null，一个表可以有多个</span><br><span class="line">3.都可以组合主键 组合唯一  就是组合中只要有一项不同就是不同的，但是不推荐使用</span><br><span class="line"></span><br><span class="line">外键：</span><br><span class="line">1.要求在从表设置外键关系</span><br><span class="line">2.从表的外键列的类型必须和主表的关联列一致或兼容</span><br><span class="line">3.要求主表的关联列必须是一个key （一般是主键或者唯一）</span><br><span class="line">4.插入数据时，先插入主表，再插入从表；删除时先删除从表，后删除主表，因为有从表的引用</span><br><span class="line"></span><br><span class="line">一个字段可以添加多个约束</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#一、创建表时添加约束</span><br><span class="line">#1.添加列级约束</span><br><span class="line"></span><br><span class="line">CREATE TABLE info(</span><br><span class="line">			id INT PRIMARY KEY,</span><br><span class="line">			s_name VARCHAR(20) NOT NULL,</span><br><span class="line">			gender CHAR(1) CHECK(gender &#x3D; &#39;男&#39;or gender &#x3D; &#39;女&#39;),</span><br><span class="line">			seat INT UNIQUE,</span><br><span class="line">			age INT DEFAULT 18,</span><br><span class="line">			majorId INT REFERENCES major(id)  #引用major表的列,列级约束无效</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE major(</span><br><span class="line">			id INT PRIMARY KEY,</span><br><span class="line">			majorName VARCHAR(20)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#查看所有的索引 </span><br><span class="line">SHOW INDEX FROM info;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.添加表级约束</span><br><span class="line">#在字段最后  【CONSTRAINT 约束名】 约束类型(约束字段)</span><br><span class="line"></span><br><span class="line">CREATE TABLE info1(</span><br><span class="line">			id INT ,</span><br><span class="line">			s_name VARCHAR(20) ,</span><br><span class="line">			gender CHAR(1) ,</span><br><span class="line">			seat INT ,</span><br><span class="line">			age INT ,</span><br><span class="line">			majorId INT,</span><br><span class="line">			</span><br><span class="line">			CONSTRAINT pk PRIMARY KEY(id,s_name),</span><br><span class="line">			CONSTRAINT uni UNIQUE(seat),</span><br><span class="line">			CONSTRAINT ck CHECK(gender &#x3D; &#39;男&#39;or gender &#x3D; &#39;女&#39;),</span><br><span class="line">			CONSTRAINT fk FOREIGN KEY(majorId) REFERENCES major(id)</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#一般除了外键使用表级约束，其他都使用列级约束</span><br><span class="line"></span><br><span class="line">#二、修改表时添加约束</span><br><span class="line">#表级约束用ADD   列级用MODIFY</span><br><span class="line"></span><br><span class="line">CREATE TABLE info2(</span><br><span class="line">			id INT ,</span><br><span class="line">			s_name VARCHAR(20) ,</span><br><span class="line">			gender CHAR(1) ,</span><br><span class="line">			seat INT ,</span><br><span class="line">			age INT ,</span><br><span class="line">			majorId INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ALTER TABLE info2 MODIFY COLUMN s_name VARCHAR(20) NOT NULL;</span><br><span class="line">ALTER TABLE info2 MODIFY COLUMN age INT DEFAULT 19;</span><br><span class="line"></span><br><span class="line">#主键</span><br><span class="line">ALTER TABLE info2 MODIFY COLUMN id PRIMARY KEY;</span><br><span class="line">ALTER TABLE info2 ADD PRIMARY KEY(id); #只有添加表级约束才可以设置约束名，省略了【CONSTRAINT 约束名】</span><br><span class="line"></span><br><span class="line">#UNIQUE</span><br><span class="line">ALTER TABLE info2 MODIFY COLUMN seat UNIQUE;</span><br><span class="line">ALTER TABLE info2 ADD UNIQUE(seat);</span><br><span class="line"></span><br><span class="line">ALTER TABLE info2 ADD FOREIGN KEY(majorId) REFERENCES major(id);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、修改表时删除约束</span><br><span class="line">ALTER TABLE info2 MODIFY COLUMN s_name VARCHAR(20) NULL;</span><br><span class="line">ALTER TABLE info2 MODIFY COLUMN age INT;</span><br><span class="line"></span><br><span class="line">ALTER TABLE info2 DROP PRIMARY;</span><br><span class="line"></span><br><span class="line">#唯一 外键 +约束名</span><br><span class="line">ALTER TABLE info2 DROP INDEX seat;</span><br><span class="line">ALTER TABLE info2 DROP FOREIGN KEY fk;</span><br></pre></td></tr></table></figure>

<h2 id="标识列-（自增长列）"><a href="#标识列-（自增长列）" class="headerlink" title="标识列 （自增长列）"></a>标识列 （自增长列）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#标识列</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line"></span><br><span class="line">自增长列</span><br><span class="line"></span><br><span class="line">含义：系统提供的默认的序列值</span><br><span class="line"></span><br><span class="line">1.标识列：必须是一个key</span><br><span class="line"></span><br><span class="line">2.一个表只能有一个自增长列</span><br><span class="line"></span><br><span class="line">3.标识列的类型：只能是数值型  一般是int</span><br><span class="line"></span><br><span class="line">4.标识列可以设置步长 set auto_increment_increment &#x3D; 3;  </span><br><span class="line">可以修改起始值  在插入的时候自己先插入一个数，再插入null</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">#一、创建表时设置标识列</span><br><span class="line"></span><br><span class="line">CREATE TABLE indentity (</span><br><span class="line">			id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">			NAME VARCHAR(20)</span><br><span class="line">	</span><br><span class="line">);</span><br><span class="line">TRUNCATE TABLE indentity;</span><br><span class="line">INSERT INTO indentity VALUES</span><br><span class="line">(NULL,&#39;john&#39;),</span><br><span class="line">(NULL,&#39;john&#39;),</span><br><span class="line">(NULL,&#39;john&#39;),</span><br><span class="line">(NULL,&#39;john&#39;),</span><br><span class="line">(NULL,&#39;john&#39;);</span><br><span class="line"></span><br><span class="line">set auto_increment_increment &#x3D; 3;  #修改步长</span><br><span class="line"></span><br><span class="line">#起始值 在插入的时候自己先插入一个数，再插入null</span><br><span class="line"></span><br><span class="line">#二、修改表时设置标识列</span><br><span class="line"></span><br><span class="line">ALTER TABLE indentity MODIFY COLUMN id 	INT PRIMARY KEY AUTO_IMCREMENT;</span><br><span class="line"></span><br><span class="line">#三、修改表时删除标识列</span><br><span class="line">ALTER TABLE indentity MODIFY COLUMN id 	INT;</span><br></pre></td></tr></table></figure>

<h1 id="TCL-事务控制"><a href="#TCL-事务控制" class="headerlink" title="TCL 事务控制"></a>TCL 事务控制</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#TCL  TRANSACTION CONTROL LANGUAGE 事务控制语言</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">事务：一个或一组语句组成一个执行单元，这个执行单元要么全部执行，要么全部不执行</span><br><span class="line"></span><br><span class="line">a转账100给b</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">需要二者同时执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">存储引擎 ：	InnoDB存储引擎 支持事务</span><br><span class="line"></span><br><span class="line">事务的特性：ACID属性</span><br><span class="line">1.原子性 atomicity ：事务是一个不可分割的工作单位，事务的操作要么发生，要么不发生</span><br><span class="line">2.一致性 consisentecy：事务会从一个一致性的状态进入另一个一致性的状态，比如转账一致</span><br><span class="line">3.隔离性 isolation： 一个事务的执行不能被其他事务干扰，即一个事务内部的操作及使用数据</span><br><span class="line">					对其他并发的事务是隔离的，并发执行的各个事务之间不能互相干扰</span><br><span class="line">4.持久性 durability ：一旦提交了就是永久性的改变，接下来的其他操作和数据库故障不应该对其有影响</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#事务的创建</span><br><span class="line">隐式事务：事务没有明显的开启和结束的标记</span><br><span class="line">比如 insert update delete</span><br><span class="line"></span><br><span class="line">显式事务：事务具有明显的开启和结束的标记</span><br><span class="line">前提：必须先设置自动提交功能为禁用</span><br><span class="line"></span><br><span class="line">1.开启事务</span><br><span class="line">SET autocommit &#x3D; 0; 只针对当前事务</span><br><span class="line">START TRANSACTION; 可选</span><br><span class="line"></span><br><span class="line">2.编写sql语句</span><br><span class="line">SELECT;</span><br><span class="line">INSERT;</span><br><span class="line">UPDATE;</span><br><span class="line">DELETE;</span><br><span class="line"></span><br><span class="line">3.结束事务</span><br><span class="line">commit;		提交</span><br><span class="line">二选一</span><br><span class="line">rollback; 回滚  </span><br><span class="line"></span><br><span class="line">前面的sql语句执行后驻留在内存中，当出现结束语句时，</span><br><span class="line">如果是commit就提交修改，如果是rollback就不写出到磁盘。所以就还是原来的数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">update 表 set 余额 &#x3D; 0 where name &#x3D; &#39;a&#39;</span><br><span class="line">意外中断</span><br><span class="line">update 表 set 余额 &#x3D; 200 where name &#x3D; &#39;b&#39;</span><br><span class="line"></span><br><span class="line">数据库的隔离级别</span><br><span class="line">对于同时运行的多个事务，就当这些事务访问数据库中相同的数据时，如果没有</span><br><span class="line">采用必要的隔离机制，就会导致各种并发问题</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">并发问题：</span><br><span class="line">脏读：对于两个事务T1 T2, T1读取了T2更新但还没有没提交的字段之后，如果T2回滚</span><br><span class="line">T1读取的内容就是临时且无效的。针对update</span><br><span class="line"></span><br><span class="line">不可重复读：T1读取了一个字段，T2更新了该字段，T1再次读取同一字段，值就不同了</span><br><span class="line"></span><br><span class="line">幻读： T1读取了一个字段，T2在该表中插入了一些新的行，T1再读会多出几行，针对insert</span><br><span class="line"></span><br><span class="line">通过设置隔离级别来解决这些问题</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">SHOW ENGINES;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#39;autocommit&#39;;</span><br></pre></td></tr></table></figure>


            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/paranoiddemon.github.io/tags/MySQL/">MySQL</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/paranoiddemon.github.io/posts/hk-election">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">香港选举制度</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/paranoiddemon.github.io/posts/speedy-revovery">
        <span class="next-text nav-default">Wish You A Speedy Recovery</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
    2020
    <span class="footer-author">Demon.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear" target="_blank" rel="noopener">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    
  





  
    <script type="text/javascript" src="/paranoiddemon.github.io/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/paranoiddemon.github.io/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/paranoiddemon.github.io/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/paranoiddemon.github.io/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
